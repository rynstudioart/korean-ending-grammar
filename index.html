<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Korean Grammar Endings — Cards</title>
<style>
  :root{
    --gap: 12px;
    --card-size: 140px;
    --accent: #2b6cb0;
    --bg: #f7fbff;
    --card-bg: #ffffff;
    --muted: #555;
  }

  body{
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    margin: 24px;
    background: linear-gradient(180deg, var(--bg), #ffffff);
    color: #111;
  }

  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom: 18px;
  }

  h1{
    margin:0;
    font-size:1.25rem;
  }
  p.lead{
    margin:0;
    color:var(--muted);
    font-size:0.95rem;
  }

  .controls{
    display:flex;
    gap:10px;
    align-items:center;
  }

  button.primary{
    background:var(--accent);
    color:white;
    border:none;
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
  }
  button.ghost{
    background:transparent;
    color:var(--accent);
    border:1px solid rgba(43,108,176,0.12);
    padding:8px 10px;
    border-radius:8px;
    cursor:pointer;
  }

  /* grid of cards */
  .grid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--card-size), 1fr));
    gap:var(--gap);
    align-items:stretch;
  }

  .card{
    background:var(--card-bg);
    border-radius:10px;
    box-shadow: 0 4px 10px rgba(20,30,40,0.06);
    min-height: var(--card-size);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    padding:12px;
    text-align:center;
    cursor:pointer;
    transition: transform .12s ease, box-shadow .12s ease;
    user-select:none;
  }
  .card:hover{ transform: translateY(-4px); box-shadow: 0 8px 20px rgba(20,30,40,0.08); }

  .ending{
    font-size:1.15rem;
    font-weight:700;
    letter-spacing:0.5px;
  }
  .translation{
    font-size:0.86rem;
    color:var(--muted);
    margin-top:6px;
  }

  /* detail modal / panel */
  .overlay{
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background: rgba(0,0,0,0.35);
    z-index:40;
    padding:20px;
  }
  .overlay.show{ display:flex; }

  .modal{
    background:white;
    width: min(720px, 96%);
    border-radius:12px;
    box-shadow:0 20px 50px rgba(0,0,0,0.25);
    padding:18px;
  }

  .modal h2{ margin:0 0 6px 0; }
  .modal .sub{ color:var(--muted); margin-bottom:12px; }

  .modal .explain{
    background:#f5f8ff;
    padding:12px;
    border-radius:8px;
    font-size:0.98rem;
  }

  .modal .row{
    display:flex;
    gap:8px;
    margin-top:12px;
    justify-content:flex-end;
  }
  .modal button{ padding:8px 10px; border-radius:8px; border:none; cursor:pointer; }
  .danger{ background:#f44336; color:white; }
  .secondary{ background:#eee; color:#222; }

  /* add form */
  form.add-form{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:flex-end;
    margin-top:14px;
    background:#fafafa;
    padding:12px;
    border-radius:8px;
  }
  form.add-form label{
    display:flex;
    flex-direction:column;
    gap:6px;
    flex: 1 1 200px;
    min-width:160px;
  }
  input[type="text"], textarea{
    padding:8px;
    border-radius:6px;
    border:1px solid #ddd;
    font-size:0.95rem;
    width:100%;
  }
  textarea{ min-height:80px; resize:vertical; }

  footer{
    margin-top:18px;
    color:var(--muted);
    font-size:0.9rem;
  }

  /* small screens */
  @media (max-width:520px){
    :root{ --card-size: 120px; }
    header{ flex-direction:column; align-items:flex-start; gap:8px; }
  }
</style>
</head>
<body>

<header>
  <div>
    <h1>Korean grammar endings — Cards</h1>
    <p class="lead">Click a card to see details.</p>
  </div>

  <div class="controls">
    
    <button class="ghost" id="resetBtn" title="Reset to initial 15 cards">Reset to initial</button>
  </div>
</header>

<main>
  <section class="grid" id="cardGrid" aria-live="polite"></section>

  <div style="margin-top:14px">
    <form id="inlineAddForm" class="add-form" aria-hidden="true" style="display:none">
      <label>
        Ending (Korean)
        <input type="text" id="endingInput" placeholder="-자" required>
      </label>
      <label>
        English translation (short)
        <input type="text" id="translationInput" placeholder="Let's ...">
      </label>
      <label style="flex:1 1 100%">
        Short explanation
        <textarea id="explainInput" placeholder="Short explanation of usage..."></textarea>
      </label>
      <div style="display:flex; gap:8px; align-items:center;">
        <button type="button" class="primary" id="saveInlineBtn">Save</button>
        <button type="button" class="secondary" id="cancelInlineBtn">Cancel</button>
      </div>
    </form>
  </div>
</main>

<!-- modal / overlay for detail view -->
<div class="overlay" id="detailOverlay" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal" role="document">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <div>
        <h2 id="modalEnding">-자</h2>
        <div class="sub" id="modalTranslation">let's do something...</div>
      </div>
      <div style="text-align:right;">
       
      </div>
    </div>

    <div style="margin-top:10px">
      <div class="explain" id="modalExplain">Explanation goes here. Example(s): ...</div>
    </div>

    <!-- edit form (hidden until Edit pressed) -->
    <form id="editForm" style="margin-top:12px; display:none;" class="add-form">
      <label>
        Ending (Korean)
        <input type="text" id="editEnding" required>
      </label>
      <label>
        English translation (short)
        <input type="text" id="editTranslation">
      </label>
      <label style="flex:1 1 100%">
        Short explanation
        <textarea id="editExplain"></textarea>
      </label>
      <div class="row">
        <button type="button" class="primary" id="saveEditBtn">Save changes</button>
        <button type="button" class="secondary" id="cancelEditBtn">Cancel</button>
      </div>
    </form>

    <div class="row" style="margin-top:10px; justify-content:flex-end;">
      <button class="secondary" id="closeModalBtn">Close</button>
    </div>
  </div>
</div>

<footer>
  
</footer>

<script>
const DEV_MODE = true;
/*
  Cards app
  - initialCards: 15 example Korean grammar endings with short translations and explanations.
  - stores current list in localStorage under 'koreanEndings'
  - allows adding, editing, deleting
  - clicking a card opens modal with details
*/

const initialCards = [
  { ending: "-습니다 / -ㅂ니다", translation: "formal polite statement", explain: "Used in formal polite contexts such as announcements, news, workplace speech." },
  { ending: "-습니까?", translation: "formal polite question", explain: "Formal interrogative ending used in polite official contexts." },
  { ending: "-ㅂ시다", translation: "let’s (formal)", explain: "Formal polite suggestion." },
  { ending: "-십시오", translation: "please do (formal command)", explain: "Respectful imperative used in formal public instructions." },

  { ending: "-아요 / -어요", translation: "polite informal", explain: "Most common polite speech used in daily conversation." },
  { ending: "-아요? / -어요?", translation: "polite question", explain: "Polite interrogative tone." },
  { ending: "-아/어 주세요", translation: "please do", explain: "Soft polite request for help or service." },
  { ending: "-아/어 줄게요", translation: "I'll do (for you)", explain: "Expresses helpful intention toward listener." },

  { ending: "-아 / -어", translation: "casual informal", explain: "Informal declarative ending." },
  { ending: "-아? / -어?", translation: "casual question", explain: "Informal question tone used with friends or younger people." },
  { ending: "-아라 / -어라", translation: "casual command", explain: "Informal imperative used to juniors or in writing." },
  { ending: "-에 따라서", translation: "depending on / according to", explain: "This expression shows that the result changes based on something.Noun + 에 따라서" },

  { ending: "-았다 / -었다", translation: "past tense", explain: "Plain form past tense." },
  { ending: "-았어요 / -었어요", translation: "past polite", explain: "Standard polite past tense used in conversation." },
  { ending: "-고 있다", translation: "is doing", explain: "Progressive aspect indicating ongoing action." },
  { ending: "-고 있었다", translation: "was doing", explain: "Past progressive form." },
  { ending: "-하ㄴ테 / 한테서", translation: "to / for / from (someone)", explain: "Used with people or animals, never with places or things." },
  { ending: "-게 되다", translation: "come to be / end up ...", explain: "Indicates a change of state or result due to circumstances." },
  { ending: "-되다", translation: "to become / to turn into / to work / to be allowed / to be possible", explain: "can mean:to become, to be allowed,passive verb marker (be done)" },
  { ending: "-아/어 버리다", translation: "completely / unfortunately", explain: "Completion with emotional nuance, often regret or relief." },
  { ending: " 그런데/근데", translation: "but", explain: "Used to mark contrast or a topic shift between two clauses or sentences. used at the begining of sentance, 그런데:neutral / formal writing,근데: informal speech" },

  { ending: "-겠다", translation: "will / intend / guess", explain: "Shows intention, promise, or speculation." },
  { ending: "-(으)ㄹ 것이다", translation: "will", explain: "Neutral future tense expression." },
  { ending: "-(으)ㄹ게요", translation: "I will (for you)", explain: "Future intention directed at listener." },
  { ending: "-(으)려고 하다", translation: "intend to", explain: "Expresses plan or intention." },
  { ending: "-(으)ㄹ 것 같다", translation: "seems like / I think", explain: "Speculation or guess with uncertainty." },
  { ending: "-나 보다", translation: "I guess / it seems", explain: "Inference based on observation." },
  { ending: "-(으)ㄴ가 보다", translation: "I guess (descriptive verbs)", explain: "Guess based on evidence for descriptive verbs." },

  { ending: "-까지", translation: "up to / until / to (a limit)", explain: "It shows the endpoint in time, place, quantity, or range." },
  { ending: "-만", translation: "only / just", explain: "It limits or restricts something." },
  { ending: "-고 있어요", translation: "present progressive", explain: "am / is / are doing. [Verb stem] + 고 있어요" },
  { ending: "-자", translation: "let’s (casual)", explain: "Informal suggestion used with close friends." },
  { ending: "-(으)ㄹ까요?", translation: "shall we? / maybe?", explain: "Suggestion or mild speculation." },
  { ending: "-시죠", translation: "let’s (formal polite)", explain: "Polite suggestion, respectful." },
  { ending: "-도", translation: "also / too", explain: "Used when something is additional.attached directly after a noun" },
  { ending: "-아요 / 어요 / 여요", translation: "present polite endings", explain: "These endings are added to a verb stem to make a polite sentence in the present tense.-아요 (bright vowel),-어요 Use when the stem does NOT end in ㅏ or ㅗ.,여요(only for 하다 verbs 해요)" },

  { ending: "-았어요 / -었어요 / -였어요", translation: "Past tense", explain: "These endings are added to the verb stem to mean did / was / were / happened." },
  { ending: "-(으)ㄹ 거예요", translation: "future tense", explain: "express will do/ going to." },
  { ending: "-지 않다", translation: "not", explain: "Long-form negation used in writing and speech." },
  { ending: "안 + verb", translation: "not", explain: "Short informal negation placed before the verb." },
  { ending: "-지 못하다", translation: "cannot (inability)", explain: "Long-form inability or impossibility." },
  { ending: "못 + verb", translation: "can’t", explain: "Short informal form indicating inability." },
  { ending: "아/어야 돼요", translation: "have to", explain: "Very common, slightly more casual" },
   { ending: "아/어야겠다", translation: "I’d better…” / “I guess I should…” / “I feel I must…", explain: "Stronger determination / self-resolution." },

  { ending: "-고", translation: "and / and then", explain: "Sequential connector indicating events in order." },
  { ending: "-는데", translation: "but / and / background", explain: "Context setting, contrast, or softening tone." },
  { ending: "-며", translation: "and / while", explain: "Written form indicating simultaneous facts or actions." },
  { ending: "-아/어 가지고", translation: "having done and then", explain: "Sequential action often implying cause." },
  { ending: "-자마자", translation: "as soon as", explain: "Immediate sequence of actions." },
  { ending: "-은/ᄂ 후에", translation: "after", explain: "More formal; also means after doing something" },
{ ending: "-고 싶다", translation: "I want to (verb).", explain: "It expresses desire of the subject (usually “I”)" },
  { ending: "-아/어야 하다", translation: "must / have to / need to do", explain: "Most common and standard form for “must / have to.”" },
  
  { ending: "-아서 / -어서", translation: "because", explain: "Casual connector expressing reason." },
  { ending: "-니까", translation: "because / since", explain: "Reason connector often used with suggestions/commands." },
  { ending: "-기 때문에", translation: "because", explain: "Neutral clear explanation of cause." },
  { ending: "-고 싶네요", translation: "feeling like", explain: "A polite, gentle way of expressing desire or intention." },
  { ending: "-에서", translation: "at / in", explain: "Use 에서 to show where an action takes place." },

  { ending: "-지만", translation: "but / although", explain: "Basic contrast connector." },
  { ending: "-는데도", translation: "even though", explain: "Strong concession expressing frustration." },
  { ending: "-아/어도", translation: "even if / even though", explain: "Conditional concession." },
  { ending: "-(으)ㄹ지라도", translation: "even if (formal)", explain: "Formal emphatic concession used in writing." },
  { ending: "-그리고", translation: "and / and then", explain: "그리고 is a conjunction used to connect:sentance, actions, ideas" },

  { ending: "-면 / -으면", translation: "if", explain: "Basic conditional structure." },
  { ending: "-(으)면 좋겠다", translation: "I wish / I hope", explain: "Wishful expression." },
  { ending: "-거든", translation: "if / when", explain: "Informal conditional often used to provide instructions." },
  { ending: "-다가", translation: "while doing / during", explain: "Interrupted or continuing action leading to another." },

  { ending: "-려고", translation: "in order to", explain: "Purpose connector." },
  { ending: "-(으)러", translation: "in order to (motion verbs)", explain: "Used with verbs like 가다/오다." },
  { ending: "-기 위해(서)", translation: "for the purpose of", explain: "Formal purpose expression." },
  { ending: "-(으)려고 해요", translation: "intend to/try to", explain: "It shows that the speaker has the purpose of doing something." },

  { ending: "-(으)ㄹ 수 있다", translation: "can / be able to", explain: "Ability or possibility." },
  { ending: "-(으)ㄹ 수 없다", translation: "cannot", explain: "Impossibility." },
  { ending: "-(으)ㄹ 줄 알다", translation: "know how to", explain: "Expresses skill." },
  { ending: "-(으)ㄹ 줄 모르다", translation: "not know how to", explain: "Lack of skill." },

  { ending: "-고 말하다", translation: "say that", explain: "Reported speech (general)." },
  { ending: "-다고 하다", translation: "say that (statement)", explain: "Quoted declarative." },
  { ending: "-냐고 하다", translation: "ask whether", explain: "Quoted question." },
  { ending: "-자고 하다", translation: "suggest that", explain: "Quoted suggestion." },
  { ending: "-(으)라고 하다", translation: "tell someone to", explain: "Quoted command." },

  { ending: "-기", translation: "nominalizer", explain: "Turns verb into noun." },
  { ending: "-는 것", translation: "the act of (doing)", explain: "Noun phrase describing an action." },
  { ending: "-음 / -ㅁ", translation: "formal nominalizer", explain: "Used in formal writing, notes, instructions." },

  { ending: "-는", translation: "present modifier", explain: "Verb modifying a noun (present)." },
  { ending: "-(으)ㄴ", translation: "past modifier", explain: "Verb modifying a noun (past)." },
  { ending: "-(으)ㄹ", translation: "future modifier", explain: "Verb modifying a noun (future/prospective)." },

  { ending: "-기는 하다", translation: "do indeed / though", explain: "Emphatic contrast." },
  { ending: "-기는 하지만", translation: "although indeed", explain: "Korean conjunction that expresses contrast or opposition between two clauses. It can be translated in a few ways depending on context: but/although" },
  { ending: "-더라", translation: "I found that / experiential", explain: "Recollection based on personal experience." },
  { ending: "-던", translation: "past incomplete recollection", explain: "Describes ongoing past events remembered." },
  { ending: "-더라고요", translation: "I found out that", explain: "Found out through personal experience." },

  { ending: "-(으)세요", translation: "please do (polite)", explain: "Polite honorific command/request." },
  { ending: "-이에요 / 예요", translation: "to be", explain: "polite form. It’s often used to introduce yourself, describe what something is, or identify someone/something." },
  { ending: "-주세요", translation: "please give/do", explain: "Common polite request." },
  { ending: "-지 마세요", translation: "please don't", explain: "Polite prohibition." },
  { ending: "-지 말다", translation: "don’t do", explain: "Command expressing prohibition.don’t (imperative)" },
   { ending: "-지 말고", translation: "don’t do", explain: "don’t do A, but instead B / and don’t do A, do B" },
   { ending: "-들", translation: "noun plural", explain: "들 is added to nouns to indicate plurality." },

  { ending: "-뿐이다", translation: "only", explain: "Expression of limitation." },
  { ending: "-(으)ㄴ 적 있다", translation: "have done", explain: "Experience form." },
  { ending: "-(으)ㄴ 적 없다", translation: "have never done", explain: "Negative experience." },
  { ending: "-게", translation: "in a way / so that", explain: "Adverb maker; manner." },
  { ending: "-도록", translation: "so that / until", explain: "Limit or purpose." },
  { ending: "-대로", translation: "according to", explain: "Pattern or accordance." },

  { ending: "-마다", translation: "every", explain: "Repetition (every day, every time...)." },
  { ending: "-밖에", translation: "nothing but / only", explain: "Used with negation to mean 'only'." },
  { ending: "-처럼", translation: "like / as", explain: "Comparison or likeness." },
  { ending: "-만큼", translation: "as much as", explain: "Degree comparison." },
  { ending: "-보다", translation: "than", explain: "Used for comparisons." },
  { ending: "-같다", translation: "seem / look like", explain: "Appearance or speculation." },

  { ending: "-군요", translation: "I see / indeed", explain: "Express new realization." },
  { ending: "-네요", translation: "surprise / realization", explain: "Soft discovery or reaction." },
  { ending: "-구나", translation: "oh, I see (casual)", explain: "Informal realization." },
  { ending: "-군", translation: "I see (plain)", explain: "Plain form of realization." },
  { ending: "-구요", translation: "and also / continuing", explain: "Soft continuation in speech." },

  { ending: "-아요/-어요 보이다", translation: "seems / appears", explain: "Expression of appearance or guess." },
  { ending: "-(으)ㄹ래요", translation: "I want to / will", explain: "Speaker’s intention (casual polite)." },
  { ending: "-(으)ㄹ 뿐만 아니라", translation: "not only but also", explain: "Adds two related statements." },
  { ending: "-(으)면서", translation: "while doing", explain: "Simultaneous action." },
  { ending: "-거든요", translation: "because (casual)", explain: "Soft explanation for listener." },
  { ending: "-잖아요", translation: "you know / as you know", explain: "Seeking agreement or reminding listener." },
  { ending: "-나요?", translation: "question (soft curious)", explain: "Gentle question used politely." },
  { ending: "-(으)ㄴ가요?", translation: "soft polite question", explain: "Polite curious tone." },
  { ending: "-지요 / -죠", translation: "isn't it? / right?", explain: "Seeking confirmation politely." },
  { ending: "-다가 보면", translation: "if you keep doing", explain: "Repeated action leading to a result." },

  { ending: "-(으)니까요", translation: "because (soft polite)", explain: "Gentle explanation, often defensive." },
  { ending: "-고나서", translation: "after doing", explain: "Sequential connector emphasizing completion." },
  { ending: "-아/어 보니", translation: "after trying / when I did", explain: "Discovery after trying something." },
  { ending: "-기도 하다", translation: "sometimes / also does", explain: "Adds variety or inclusion." },
  { ending: "-고 보니", translation: "when I looked / after doing", explain: "Realization after an action." }
];

// util: read / write localStorage
function loadCards(){
  if (!DEV_MODE) {
    try{
      const raw = localStorage.getItem('koreanEndings');
      if(!raw) return null;
      const parsed = JSON.parse(raw);
      if(!Array.isArray(parsed)) return null;
      return parsed;
    }catch(e){
      return null;
    }
  }
  return null; // ignores localStorage in DEV_MODE
}

function saveCards(arr){
  if (!DEV_MODE) {
    localStorage.setItem('koreanEndings', JSON.stringify(arr));
  }
}


// render grid from array of {ending, translation, explain}
const grid = document.getElementById('cardGrid');
let cards = loadCards() || initialCards.slice();
saveCards(cards); // ensure saved

function renderGrid(){
  grid.innerHTML = "";
  cards.forEach((c, idx) => {
    const el = document.createElement('div');
    el.className = 'card';
    el.setAttribute('data-idx', idx);
    el.setAttribute('tabindex', 0);
    el.setAttribute('role', 'button');
    el.innerHTML = `
      <div class="ending">${escapeHtml(c.ending)}</div>
      <div class="translation">${escapeHtml(c.translation)}</div>
    `;
    el.addEventListener('click', () => openDetail(idx));
    el.addEventListener('keypress', (e) => { if(e.key === 'Enter' || e.key === ' ') openDetail(idx); });
    grid.appendChild(el);
  });
}
renderGrid();

// small escape helper
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }


/* DETAIL MODAL */
const overlay = document.getElementById('detailOverlay');
const modalEnding = document.getElementById('modalEnding');
const modalTranslation = document.getElementById('modalTranslation');
const modalExplain = document.getElementById('modalExplain');
let currentIndex = null;

function openDetail(idx){
  currentIndex = idx;
  const c = cards[idx];
  modalEnding.textContent = c.ending;
  modalTranslation.textContent = c.translation;
  modalExplain.textContent = c.explain || "(no explanation provided)";
  overlay.classList.add('show');
  overlay.setAttribute('aria-hidden', 'false');
  document.getElementById('editForm').style.display = 'none';
}
function closeDetail(){
  overlay.classList.remove('show');
  overlay.setAttribute('aria-hidden', 'true');
  currentIndex = null;
}

/* modal buttons */
document.getElementById('closeModalBtn').addEventListener('click', closeDetail);
overlay.addEventListener('click', (e) => {
  if(e.target === overlay) closeDetail();
});



/* edit */
const editBtn = document.getElementById('editBtn');
const editForm = document.getElementById('editForm');
const editEnding = document.getElementById('editEnding');
const editTranslation = document.getElementById('editTranslation');
const editExplain = document.getElementById('editExplain');

editBtn.addEventListener('click', () => {
  if(currentIndex === null) return;
  const c = cards[currentIndex];
  editEnding.value = c.ending;
  editTranslation.value = c.translation;
  editExplain.value = c.explain || "";
  editForm.style.display = 'flex'; // show
  editForm.scrollIntoView({behavior:'smooth', block:'center'});
});

document.getElementById('saveEditBtn').addEventListener('click', () => {
  if(currentIndex === null) return;
  const newEnding = editEnding.value.trim();
  if(!newEnding){ alert("Please enter the Korean ending."); return; }
  const newTrans = editTranslation.value.trim();
  const newExp = editExplain.value.trim();
  cards[currentIndex] = { ending: newEnding, translation: newTrans, explain: newExp };
  saveCards(cards);
  renderGrid();
  // update modal content
  modalEnding.textContent = newEnding;
  modalTranslation.textContent = newTrans;
  modalExplain.textContent = newExp || "(no explanation provided)";
  editForm.style.display = 'none';
});

document.getElementById('cancelEditBtn').addEventListener('click', () => {
  editForm.style.display = 'none';
});

/* ADD NEW CARD: inline form toggled by top button or visible form */
const openAddBtn = document.getElementById('openAddBtn');
const inlineAddForm = document.getElementById('inlineAddForm');
const endingInput = document.getElementById('endingInput');
const translationInput = document.getElementById('translationInput');
const explainInput = document.getElementById('explainInput');
const saveInlineBtn = document.getElementById('saveInlineBtn');
const cancelInlineBtn = document.getElementById('cancelInlineBtn');

openAddBtn.addEventListener('click', () => {
  // show inline form
  inlineAddForm.style.display = inlineAddForm.style.display === 'none' || inlineAddForm.style.display === '' ? 'flex' : 'none';
  endingInput.focus();
});

saveInlineBtn.addEventListener('click', () => {
  const e = endingInput.value.trim();
  if(!e){ alert("Please enter the Korean ending (e.g. -자)."); endingInput.focus(); return; }
  const t = translationInput.value.trim();
  const ex = explainInput.value.trim();
  cards.push({ ending: e, translation: t, explain: ex });
  saveCards(cards);
  renderGrid();
  // clear inputs
  endingInput.value = ""; translationInput.value = ""; explainInput.value = "";
  inlineAddForm.style.display = 'none';
});

cancelInlineBtn.addEventListener('click', () => {
  endingInput.value = ""; translationInput.value = ""; explainInput.value = "";
  inlineAddForm.style.display = 'none';
});

/* reset to initial */
document.getElementById('resetBtn').addEventListener('click', () => {
  if(!confirm("Reset to the original cards? This will remove any cards you added.")) return;
  cards = initialCards.slice();
  saveCards(cards);
  renderGrid();
});

/* keyboard escape to close modal */
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape'){
    if(overlay.classList.contains('show')) closeDetail();
    if(inlineAddForm.style.display === 'flex') inlineAddForm.style.display = 'none';
  }
});

/* initialize accessible attributes */
overlay.setAttribute('aria-hidden', 'true');

</script>
</body>
</html>
